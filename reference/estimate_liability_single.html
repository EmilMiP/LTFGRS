<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimating the genetic or full liability — estimate_liability_single • LTFGRS</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimating the genetic or full liability — estimate_liability_single"><meta name="description" content="estimate_liability_single estimates the genetic component of the full
liability and/or the full liability for a number of individuals based
on their family history."><meta property="og:description" content="estimate_liability_single estimates the genetic component of the full
liability and/or the full liability for a number of individuals based
on their family history."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">LTFGRS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EmilMiP/LTFGRS/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimating the genetic or full liability</h1>
      <small class="dont-index">Source: <a href="https://github.com/EmilMiP/LTFGRS/blob/main/R/Estimate_Liabilities.R" class="external-link"><code>R/Estimate_Liabilities.R</code></a></small>
      <div class="d-none name"><code>estimate_liability_single.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>estimate_liability_single</code> estimates the genetic component of the full
liability and/or the full liability for a number of individuals based
on their family history.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">estimate_liability_single</span><span class="op">(</span></span>
<span>  .tbl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  family_graphs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  h2 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  pid <span class="op">=</span> <span class="st">"PID"</span>,</span>
<span>  fam_id <span class="op">=</span> <span class="st">"fam_ID"</span>,</span>
<span>  family_graphs_col <span class="op">=</span> <span class="st">"fam_graph"</span>,</span>
<span>  role <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"PA"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--tbl">.tbl<a class="anchor" aria-label="anchor" href="#arg--tbl"></a></dt>
<dd><p>A matrix, list or data frame that can be converted into a tibble.
Must have at least five columns that hold the family identifier, the personal
identifier, the role and the lower and upper thresholds. Note that the
role must be one of the following abbreviations
- <code>g</code> (Genetic component of full liability)
- <code>o</code> (Full liability)
- <code>m</code> (Mother)
- <code>f</code> (Father)
- <code>c[0-9]*.[0-9]*</code> (Children)
- <code>mgm</code> (Maternal grandmother)
- <code>mgf</code> (Maternal grandfather)
- <code>pgm</code> (Paternal grandmother)
- <code>pgf</code> (Paternal grandfather)
- <code>s[0-9]*</code> (Full siblings)
- <code>mhs[0-9]*</code> (Half-siblings - maternal side)
- <code>phs[0-9]*</code> (Half-siblings - paternal side)
- <code>mau[0-9]*</code> (Aunts/Uncles - maternal side)
- <code>pau[0-9]*</code> (Aunts/Uncles - paternal side).
Defaults to <code>NULL</code>.</p></dd>


<dt id="arg-family-graphs">family_graphs<a class="anchor" aria-label="anchor" href="#arg-family-graphs"></a></dt>
<dd><p>A tibble with columns pid and family_graph_col.
See prepare_graph for construction of the graphs. The family graphs Defaults to NULL.</p></dd>


<dt id="arg-h-">h2<a class="anchor" aria-label="anchor" href="#arg-h-"></a></dt>
<dd><p>A number representing the heritability on liability scale
for a single phenotype. Must be non-negative. Note that under the liability threshold model,
the heritability must also be at most 1.
Defaults to 0.5.</p></dd>


<dt id="arg-pid">pid<a class="anchor" aria-label="anchor" href="#arg-pid"></a></dt>
<dd><p>A string holding the name of the column in <code>.tbl</code> (or <code>family</code> and
<code>threshs</code>) that hold the personal identifier(s). Defaults to "PID".</p></dd>


<dt id="arg-fam-id">fam_id<a class="anchor" aria-label="anchor" href="#arg-fam-id"></a></dt>
<dd><p>A string holding the name of the column in <code>.tbl</code> or <code>family</code> that
holds the family identifier. Defaults to "fam_ID".</p></dd>


<dt id="arg-family-graphs-col">family_graphs_col<a class="anchor" aria-label="anchor" href="#arg-family-graphs-col"></a></dt>
<dd><p>Name of column with family graphs in family_graphs. Defaults to "fam_graph".</p></dd>


<dt id="arg-role">role<a class="anchor" aria-label="anchor" href="#arg-role"></a></dt>
<dd><p>A string holding the name of the column in <code>.tbl</code> that
holds the role. Each role must be chosen from the following list of abbreviations
- <code>g</code> (Genetic component of full liability)
- <code>o</code> (Full liability)
- <code>m</code> (Mother)
- <code>f</code> (Father)
- <code>c[0-9]*.[0-9]*</code> (Children)
- <code>mgm</code> (Maternal grandmother)
- <code>mgf</code> (Maternal grandfather)
- <code>pgm</code> (Paternal grandmother)
- <code>pgf</code> (Paternal grandfather)
- <code>s[0-9]*</code> (Full siblings)
- <code>mhs[0-9]*</code> (Half-siblings - maternal side)
- <code>phs[0-9]*</code> (Half-siblings - paternal side)
- <code>mau[0-9]*</code> (Aunts/Uncles - maternal side)
- <code>pau[0-9]*</code> (Aunts/Uncles - paternal side).
Defaults to "role".</p></dd>


<dt id="arg-out">out<a class="anchor" aria-label="anchor" href="#arg-out"></a></dt>
<dd><p>A character or numeric vector indicating whether the genetic component
of the full liability, the full liability or both should be returned. If <code>out = c(1)</code> or
<code>out = c("genetic")</code>, the genetic liability is estimated and returned. If <code>out = c(2)</code> or
<code>out = c("full")</code>, the full liability is estimated and returned. If <code>out = c(1,2)</code> or
<code>out = c("genetic", "full")</code>, both components are estimated and returned.
Defaults to <code>c(1)</code>.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>A number that is used as the convergence criterion for the Gibbs sampler.
Equals the standard error of the mean. That is, a tolerance of 0.2 means that the
standard error of the mean is below 0.2. Defaults to 0.01.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Estimation method used to estimate the (genetic) liability. Defaults to "PA".
Current implementation of PA only supports estimates of genetic liability. For full or both
genetic and full liability estimates use "Gibbs".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>family</code> and <code>threshs</code> are two matrices, lists or
data frames that can be converted into tibbles, if <code>family</code> has two
columns named like the strings represented in <code>pid</code> and <code>fam_id</code>, if
<code>threshs</code> has a column named like the string given in <code>pid</code> as
well as a column named "lower" and a column named "upper" and if the
liability-scale heritability <code>h2</code>, <code>out</code>, <code>tol</code> and
<code>always_add</code> are of the required form, then the function returns a
tibble with either four or six columns (depending on the length of out).
The first two columns correspond to the columns <code>fam_id</code> and <code>pid</code> '
present in <code>family</code>.
If <code>out</code> is equal to <code>c(1)</code> or <code>c("genetic")</code>, the third
and fourth column hold the estimated genetic liability as well as the
corresponding standard error, respectively.
If <code>out</code> equals <code>c(2)</code> or <code>c("full")</code>, the third and
fourth column hold the estimated full liability as well as the
corresponding standard error, respectively.
If <code>out</code> is equal to <code>c(1,2)</code> or <code>c("genetic","full")</code>,
the third and fourth column hold the estimated genetic liability as
well as the corresponding standard error, respectively, while the fifth and
sixth column hold the estimated full liability as well as the corresponding
standard error, respectively.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function can be used to estimate either the genetic component of the
full liability, the full liability or both. It is possible to input either</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://future.apply.futureverse.org/reference/future_apply.html" class="external-link">future_apply</a></code>, <code><a href="estimate_liability_multi.html">estimate_liability_multi</a></code>,
<code><a href="estimate_liability.html">estimate_liability</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate_under_LTM.html">simulate_under_LTM</a></span><span class="op">(</span>fam_vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m"</span>,<span class="st">"f"</span>,<span class="st">"s1"</span><span class="op">)</span>, n_fam <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>add_ind <span class="op">=</span> <span class="cn">TRUE</span>, h2 <span class="op">=</span> <span class="fl">0.5</span>, n_sim<span class="op">=</span><span class="fl">10</span>, pop_prev <span class="op">=</span> <span class="fl">.05</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="fu">estimate_liability_single</span><span class="op">(</span>.tbl <span class="op">=</span> <span class="va">sims</span><span class="op">$</span><span class="va">thresholds</span>,</span></span>
<span class="r-in"><span>h2 <span class="op">=</span> <span class="fl">0.5</span>, pid <span class="op">=</span> <span class="st">"indiv_ID"</span>, fam_id <span class="op">=</span> <span class="st">"fam_ID"</span>, role <span class="op">=</span> <span class="st">"role"</span>, out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>tol <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The number of workers is 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 10 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    fam_ID    indiv_ID      est   var</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> fam_ID_1  fam_ID_1  -<span style="color: #BB0000;">0.019</span><span style="color: #BB0000; text-decoration: underline;">7</span> 0.487</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> fam_ID_2  fam_ID_2  -<span style="color: #BB0000;">0.017</span><span style="color: #BB0000; text-decoration: underline;">3</span> 0.489</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> fam_ID_3  fam_ID_3  -<span style="color: #BB0000;">0.030</span><span style="color: #BB0000; text-decoration: underline;">0</span> 0.481</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> fam_ID_4  fam_ID_4  -<span style="color: #BB0000;">0.033</span><span style="color: #BB0000; text-decoration: underline;">7</span> 0.483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> fam_ID_5  fam_ID_5  -<span style="color: #BB0000;">0.019</span><span style="color: #BB0000; text-decoration: underline;">1</span> 0.489</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> fam_ID_6  fam_ID_6  -<span style="color: #BB0000;">0.039</span><span style="color: #BB0000; text-decoration: underline;">3</span> 0.479</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> fam_ID_7  fam_ID_7  -<span style="color: #BB0000;">0.037</span><span style="color: #BB0000; text-decoration: underline;">2</span> 0.479</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> fam_ID_8  fam_ID_8  -<span style="color: #BB0000;">0.022</span><span style="color: #BB0000; text-decoration: underline;">6</span> 0.486</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> fam_ID_9  fam_ID_9  -<span style="color: #BB0000;">0.013</span><span style="color: #BB0000; text-decoration: underline;">6</span> 0.492</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> fam_ID_10 fam_ID_10 -<span style="color: #BB0000;">0.034</span><span style="color: #BB0000; text-decoration: underline;">2</span> 0.482</span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate_under_LTM.html">simulate_under_LTM</a></span><span class="op">(</span>fam_vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>, n_fam <span class="op">=</span> <span class="cn">NULL</span>, add_ind <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>h2 <span class="op">=</span> <span class="fl">0.5</span>, n_sim<span class="op">=</span><span class="fl">10</span>, pop_prev <span class="op">=</span> <span class="fl">.05</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Neither fam_vec nor n_fam is specified...</span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="fu">estimate_liability_single</span><span class="op">(</span>.tbl <span class="op">=</span> <span class="va">sims</span><span class="op">$</span><span class="va">thresholds</span>,</span></span>
<span class="r-in"><span>h2 <span class="op">=</span> <span class="fl">0.5</span>, pid <span class="op">=</span> <span class="st">"indiv_ID"</span>, fam_id <span class="op">=</span> <span class="st">"fam_ID"</span>, role <span class="op">=</span> <span class="st">"role"</span>,</span></span>
<span class="r-in"><span>out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"genetic"</span><span class="op">)</span>, tol <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The number of workers is 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 10 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    fam_ID    indiv_ID        est   var</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> fam_ID_1  fam_ID_1  -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">687</span> 0.499</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> fam_ID_2  fam_ID_2  -<span style="color: #BB0000;">0.005</span><span style="color: #BB0000; text-decoration: underline;">11</span>  0.493</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> fam_ID_3  fam_ID_3  -<span style="color: #BB0000;">0.002</span><span style="color: #BB0000; text-decoration: underline;">39</span>  0.496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> fam_ID_4  fam_ID_4  -<span style="color: #BB0000;">0.002</span><span style="color: #BB0000; text-decoration: underline;">14</span>  0.497</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> fam_ID_5  fam_ID_5  -<span style="color: #BB0000;">0.002</span><span style="color: #BB0000; text-decoration: underline;">39</span>  0.496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> fam_ID_6  fam_ID_6  -<span style="color: #BB0000;">0.001</span><span style="color: #BB0000; text-decoration: underline;">22</span>  0.498</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> fam_ID_7  fam_ID_7  -<span style="color: #BB0000;">0.004</span><span style="color: #BB0000; text-decoration: underline;">13</span>  0.494</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> fam_ID_8  fam_ID_8  -<span style="color: #BB0000;">0.002</span><span style="color: #BB0000; text-decoration: underline;">39</span>  0.496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> fam_ID_9  fam_ID_9  -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">687</span> 0.499</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> fam_ID_10 fam_ID_10 -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">191</span> 0.500</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jane Doe.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>


<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>LTFGRS Workflow: Prepare Genetic Liability for Prediction • LTFGRS</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="LTFGRS Workflow: Prepare Genetic Liability for Prediction">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">LTFGRS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/LTFGRS_workflow_prediction.html">LTFGRS Workflow: Prepare Genetic Liability for Prediction</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EmilMiP/LTFGRS/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="LTFGRS_workflow_prediction_files/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="LTFGRS_workflow_prediction_files/pagedtable-1.1/js/pagedtable.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>LTFGRS Workflow: Prepare Genetic Liability for Prediction</h1>
                        <h4 data-toc-skip class="author">Emil M.
Pedersen</h4>
            
            <h4 data-toc-skip class="date">2025-05-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/EmilMiP/LTFGRS/blob/main/vignettes/LTFGRS_workflow_prediction.Rmd" class="external-link"><code>vignettes/LTFGRS_workflow_prediction.Rmd</code></a></small>
      <div class="d-none name"><code>LTFGRS_workflow_prediction.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://emilmip.github.io/LTFGRS/">LTFGRS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/rmarkdown" class="external-link">rmarkdown</a></span><span class="op">)</span></span></code></pre></div>
<p><strong><em>All data is simulated and is purely for demonstration
purposes - This includes the CIP.</em></strong></p>
<p>This vignette is intended to give users of the package an overview of
how to use the different functions of the package and how they are
intended to work together. The liability-based predictors can be used
for prediction or as a refined outcome in a GWAS. This vignette focuses
on preparing for prediction, as this purpose requires the user to
consider additional steps, such as censoring of future events and
masking the outcome of the target individual. The vignette will cover
the following steps:</p>
<ul>
<li>Simulate mock trio, phenotype, and CIP data</li>
<li>Convert mock trio and phenotype data into a format suitable for
estimate_liability()
<ul>
<li>Automatic identification of n-degree relatives</li>
<li>Censoring of future events on a family basis</li>
<li>Assign thresholds on censored families</li>
<li>Assign thresholds to family graphs</li>
</ul>
</li>
<li>Estimate the liability-based predictors using estimate_liability()
<ul>
<li>Both Gibbs and PA based estimators will be covered</li>
</ul>
</li>
</ul>
<div class="section level2">
<h2 id="simulate-mock-trio-phenotype-and-cip-data">Simulate mock trio, phenotype, and CIP data<a class="anchor" aria-label="anchor" href="#simulate-mock-trio-phenotype-and-cip-data"></a>
</h2>
<p>We will set some population parameters for the simulation. The
parameters are as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># population parameters and seed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">555</span><span class="op">)</span></span>
<span><span class="va">h2</span> <span class="op">=</span> <span class="fl">.5</span> <span class="co"># heritability</span></span>
<span><span class="va">K</span> <span class="op">=</span> <span class="fl">.3</span> <span class="co"># population prevalence</span></span></code></pre></div>
<div class="section level3">
<h3 id="cumulative-incidence-proportions-cip">Cumulative incidence proportions (CIP)<a class="anchor" aria-label="anchor" href="#cumulative-incidence-proportions-cip"></a>
</h3>
<p>One of the key required input variables of LTFGRS is the population
representative stratified cumulative incidence proportions (CIP) data.
LTFGRS is able to utilise the population representative stratified CIPs
to personalise thresholds for the liability-based predictors. The CIPs
are typically obtained from large population registers or other sources
that allow for population representative estimates. Here, we simulate a
format similar to how stratified CIPs may be stored. We assume the CIPs
have been stratified by sex and birth year. The population
representative stratified CIPs has the interpretation of being the
proportion of individuals born in a given year and sex that has been
diagnosed with the outcome of interest by age
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># assuming we have been provided a CIP object of the following style:</span></span>
<span><span class="va">CIP</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>                       birth_year <span class="op">=</span> <span class="fl">1900</span><span class="op">:</span><span class="fl">2024</span>,</span>
<span>                       sex <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sex</span>, <span class="va">birth_year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cip <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span> <span class="op">*</span> <span class="va">K</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 25,000 × 4</span></span></span>
<span><span class="co">#&gt;      age birth_year   sex   cip</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1       <span style="text-decoration: underline;">1</span>900     0 0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2       <span style="text-decoration: underline;">1</span>900     0 0.003</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3       <span style="text-decoration: underline;">1</span>900     0 0.006</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4       <span style="text-decoration: underline;">1</span>900     0 0.009</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     5       <span style="text-decoration: underline;">1</span>900     0 0.012</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     6       <span style="text-decoration: underline;">1</span>900     0 0.015</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     7       <span style="text-decoration: underline;">1</span>900     0 0.018</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     8       <span style="text-decoration: underline;">1</span>900     0 0.021</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     9       <span style="text-decoration: underline;">1</span>900     0 0.024</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    10       <span style="text-decoration: underline;">1</span>900     0 0.027</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 24,990 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="trio-information">Trio information<a class="anchor" aria-label="anchor" href="#trio-information"></a>
</h3>
<p>The trio information presented here is a manually constructed to
resemble a typical way the trio data may be stored. The names are chosen
such that they resemble the relationship to the proband. This means
there are simple names such as “dad”, “mom”, or “sib”. There are also
more complex names such as “pgf” for maternal grand father, “muncle” for
maternal uncle”, “hsmcousin” for half-sibiling maternal cousin, etc. The
suffixes “H” and “W” mean husband and wife, respectively.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># hand curated trio information, taken from LTFHPlus vignette:</span></span>
<span><span class="co"># https://emilmip.github.io/LTFHPlus/articles/FromTrioToFamilies.html</span></span>
<span><span class="va">family</span> <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">id</span>, <span class="op">~</span><span class="va">momcol</span>, <span class="op">~</span><span class="va">dadcol</span>,</span>
<span>  <span class="st">"pid"</span>, <span class="st">"mom"</span>, <span class="st">"dad"</span>,</span>
<span>  <span class="st">"sib"</span>, <span class="st">"mom"</span>, <span class="st">"dad"</span>,</span>
<span>  <span class="st">"mhs"</span>, <span class="st">"mom"</span>, <span class="st">"dad2"</span>,</span>
<span>  <span class="st">"phs"</span>, <span class="st">"mom2"</span>, <span class="st">"dad"</span>,</span>
<span>  <span class="st">"mom"</span>, <span class="st">"mgm"</span>, <span class="st">"mgf"</span>,</span>
<span>  <span class="st">"dad"</span>, <span class="st">"pgm"</span>, <span class="st">"pgf"</span>,</span>
<span>  <span class="st">"dad2"</span>, <span class="st">"pgm2"</span>, <span class="st">"pgf2"</span>,</span>
<span>  <span class="st">"paunt"</span>, <span class="st">"pgm"</span>, <span class="st">"pgf"</span>,</span>
<span>  <span class="st">"pacousin"</span>, <span class="st">"paunt"</span>, <span class="st">"pauntH"</span>,</span>
<span>  <span class="st">"hspaunt"</span>, <span class="st">"pgm"</span>, <span class="st">"newpgf"</span>,</span>
<span>  <span class="st">"hspacousin"</span>, <span class="st">"hspaunt"</span>, <span class="st">"hspauntH"</span>,</span>
<span>  <span class="st">"puncle"</span>, <span class="st">"pgm"</span>, <span class="st">"pgf"</span>,</span>
<span>  <span class="st">"pucousin"</span>, <span class="st">"puncleW"</span>, <span class="st">"puncle"</span>,</span>
<span>  <span class="st">"maunt"</span>, <span class="st">"mgm"</span>, <span class="st">"mgf"</span>,</span>
<span>  <span class="st">"macousin"</span>, <span class="st">"maunt"</span>, <span class="st">"mauntH"</span>,</span>
<span>  <span class="st">"hsmuncle"</span>, <span class="st">"newmgm"</span>, <span class="st">"mgf"</span>,</span>
<span>  <span class="st">"hsmucousin"</span>, <span class="st">"hsmuncleW"</span>, <span class="st">"hsmuncle"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="phenotype-data">Phenotype data<a class="anchor" aria-label="anchor" href="#phenotype-data"></a>
</h3>
<p>We will simulate a liability based on the family structure defined
above to assign a case-control outcome to each individual. Then other
covariates such as sex and age are randomly assigned. To get the
case-control status, we first generate a (population) graph, calculate a
kinship matrix based on the heritability and kinship coefficient, and
finally, draw liabilities from a multivariate normal with the calculated
kinship matrix as covariance matrix.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># creating a graph for the family</span></span>
<span><span class="va">graph</span> <span class="op">=</span> <span class="fu"><a href="../reference/prepare_graph.html">prepare_graph</a></span><span class="op">(</span>.tbl <span class="op">=</span> <span class="va">family</span>, icol <span class="op">=</span> <span class="st">"id"</span>, mcol <span class="op">=</span> <span class="st">"momcol"</span>, fcol <span class="op">=</span> <span class="st">"dadcol"</span><span class="op">)</span></span>
<span><span class="co"># calculating the kinship matrix based on the graph</span></span>
<span><span class="va">cov_mat</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_covmat.html">get_covmat</a></span><span class="op">(</span>fam_graph <span class="op">=</span> <span class="va">graph</span>, h2 <span class="op">=</span> <span class="va">h2</span>, index_id <span class="op">=</span> <span class="st">"pid"</span><span class="op">)</span></span>
<span><span class="co"># creating a phenotype for the family</span></span>
<span><span class="va">liabs</span> <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">cov_mat</span><span class="op">)</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="va">cov_mat</span><span class="op">)</span></span></code></pre></div>
<p>Next, we will create the mock phenotype data:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># these values are simulated only for illustrative purposes and not to make sense(!)</span></span>
<span><span class="va">pheno</span> <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">liabs</span><span class="op">)</span>,</span>
<span>  status <span class="op">=</span> <span class="va">liabs</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="va">K</span>, lower.tail <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>,</span>
<span>  <span class="co"># no consideration for generation etc in sex, fdato or birth_year:</span></span>
<span>  sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">liabs</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  fdato <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">dmy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">28</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">liabs</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, <span class="st">"/"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">liabs</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, <span class="st">"/"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1940</span><span class="op">:</span><span class="fl">2000</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">liabs</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  birth_year <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html" class="external-link">year</a></span><span class="op">(</span><span class="va">fdato</span><span class="op">)</span>,</span>
<span>  <span class="co"># age of onset only after fdato</span></span>
<span>  adhd <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2_chr</a></span><span class="op">(</span>.x <span class="op">=</span> <span class="va">status</span>, .y <span class="op">=</span> <span class="va">birth_year</span>,</span>
<span>      <span class="op">~</span> <span class="kw">if</span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">28</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"/"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"/"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="op">(</span><span class="va">.y</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="fl">2023</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="kw">else</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  <span class="co"># end of follow up assigned here</span></span>
<span>  indiv_eof <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">dmy</a></span><span class="op">(</span><span class="st">"31/12/2010"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># converting to date format</span></span>
<span>    adhd <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">dmy</a></span><span class="op">(</span><span class="va">adhd</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">id</span> <span class="op">!=</span> <span class="st">"pid_g"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># remove the genetic liability of the proband</span></span>
<span>  <span class="co"># status is not required here. Only used it to generate the age of diagnosis.</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">status</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html" class="external-link">paged_table</a></span><span class="op">(</span><span class="va">pheno</span><span class="op">)</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["id"],"name":[1],"type":["chr"],"align":["left"]},{"label":["sex"],"name":[2],"type":["int"],"align":["right"]},{"label":["fdato"],"name":[3],"type":["date"],"align":["right"]},{"label":["birth_year"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["adhd"],"name":[5],"type":["date"],"align":["right"]},{"label":["indiv_eof"],"name":[6],"type":["date"],"align":["right"]}],"data":[{"1":"dad","2":"0","3":"1957-09-16","4":"1957","5":"<NA>","6":"2010-12-31"},{"1":"mom","2":"0","3":"1957-09-17","4":"1957","5":"1969-11-08","6":"2010-12-31"},{"1":"dad2","2":"1","3":"2000-01-27","4":"2000","5":"<NA>","6":"2010-12-31"},{"1":"mom2","2":"1","3":"1978-08-17","4":"1978","5":"<NA>","6":"2010-12-31"},{"1":"mgf","2":"1","3":"1993-11-04","4":"1993","5":"2004-04-23","6":"2010-12-31"},{"1":"mgm","2":"1","3":"1953-03-23","4":"1953","5":"<NA>","6":"2010-12-31"},{"1":"pgf","2":"1","3":"2000-06-10","4":"2000","5":"2008-12-22","6":"2010-12-31"},{"1":"pgm","2":"1","3":"1998-09-13","4":"1998","5":"<NA>","6":"2010-12-31"},{"1":"pgf2","2":"1","3":"1977-12-11","4":"1977","5":"2018-11-28","6":"2010-12-31"},{"1":"pgm2","2":"0","3":"1994-11-16","4":"1994","5":"<NA>","6":"2010-12-31"},{"1":"pauntH","2":"1","3":"1997-11-05","4":"1997","5":"<NA>","6":"2010-12-31"},{"1":"paunt","2":"0","3":"1982-03-24","4":"1982","5":"<NA>","6":"2010-12-31"},{"1":"newpgf","2":"1","3":"1976-05-22","4":"1976","5":"1979-12-16","6":"2010-12-31"},{"1":"hspauntH","2":"0","3":"1998-05-13","4":"1998","5":"2000-07-09","6":"2010-12-31"},{"1":"hspaunt","2":"0","3":"1973-12-09","4":"1973","5":"<NA>","6":"2010-12-31"},{"1":"puncle","2":"0","3":"1991-02-13","4":"1991","5":"<NA>","6":"2010-12-31"},{"1":"puncleW","2":"1","3":"1997-09-16","4":"1997","5":"<NA>","6":"2010-12-31"},{"1":"mauntH","2":"0","3":"1995-10-10","4":"1995","5":"<NA>","6":"2010-12-31"},{"1":"maunt","2":"0","3":"1956-10-04","4":"1956","5":"<NA>","6":"2010-12-31"},{"1":"newmgm","2":"0","3":"1945-06-17","4":"1945","5":"1970-09-26","6":"2010-12-31"},{"1":"hsmuncle","2":"0","3":"1948-08-08","4":"1948","5":"2015-04-21","6":"2010-12-31"},{"1":"hsmuncleW","2":"0","3":"1961-04-17","4":"1961","5":"1972-11-07","6":"2010-12-31"},{"1":"sib","2":"1","3":"1969-11-11","4":"1969","5":"<NA>","6":"2010-12-31"},{"1":"pid","2":"1","3":"1958-10-17","4":"1958","5":"<NA>","6":"2010-12-31"},{"1":"mhs","2":"0","3":"1958-11-21","4":"1958","5":"1991-03-02","6":"2010-12-31"},{"1":"phs","2":"0","3":"1987-06-01","4":"1987","5":"<NA>","6":"2010-12-31"},{"1":"pacousin","2":"0","3":"1984-02-23","4":"1984","5":"<NA>","6":"2010-12-31"},{"1":"hspacousin","2":"1","3":"1975-11-18","4":"1975","5":"2018-09-18","6":"2010-12-31"},{"1":"pucousin","2":"1","3":"1995-03-01","4":"1995","5":"2019-05-09","6":"2010-12-31"},{"1":"macousin","2":"1","3":"1949-06-16","4":"1949","5":"<NA>","6":"2010-12-31"},{"1":"hsmucousin","2":"0","3":"1996-05-03","4":"1996","5":"2008-11-09","6":"2010-12-31"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The mock phenotype data is intended to resemble a format that can
typically be derived from most register or bio bank phenotypes where the
age of diagnosis is available. Columns of interest are:</p>
<ul>
<li>
<code>fdato</code>: the birth date of the individual</li>
<li>
<code>birth_year</code>: the birth year of the individual</li>
<li>
<code>adhd</code>: the outcome of interest,</li>
<li>
<code>indiv_eof</code>: the personalised end of follow up for a
given individual. it may be different for each individual due to any
number of censoring or competing events.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="preparing-for-estimate_liability">Preparing for estimate_liability()<a class="anchor" aria-label="anchor" href="#preparing-for-estimate_liability"></a>
</h2>
<p>In a real world scenario, we will not have access to all of the
information used above. We will assume that the objects
<code>CIP</code>, <code>family</code>, and <code>pheno</code> are the
only information available to the user. These objects hold information
that can often be extracted from population registers or bio banks.</p>
<ul>
<li>
<code>CIP</code>: The <code>CIP</code> object carry information
about the prevalence of the outcome of interest in the population and
therefore also on how each participant fits into the population
distribution.</li>
<li>
<code>family</code>: The <code>family</code> object holds the trio
information, i.e. information about the family structure and how each
individual is related to each other. In a real world scenario this
object may contains millions of unique individuals.</li>
<li>
<code>pheno</code>: The <code>pheno</code> object holds phenotypic
information on each individual present in the trio information.</li>
</ul>
<div class="section level3">
<h3 id="automatic-identification-of-n-degree-relatives">Automatic identification of n-degree relatives<a class="anchor" aria-label="anchor" href="#automatic-identification-of-n-degree-relatives"></a>
</h3>
<p>When we want to calculate a family genetic risk score, we need to
create a pedigree based on the proband and relations should be relative
to the proband. We are interested in identifying all family members up
to some degree of relatedness,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>,
without having to manually find all of these family members. Manually
identifying family members up to degree
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>4</mn><annotation encoding="application/x-tex">4</annotation></semantics></math>
is both time consuming and error prone. We have implemented an automatic
detection of family members that utilise a graph based on all
individuals in the trio information (ideally population registers) and
neighbourhood graphs. In short, we create a pedigree (directed graph)
with every individual in the trio data and copy sections around a
proband with all individuals that are
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
steps away from the proband in the graph (This is a neighbourhood graphs
of degree n, here called a family graph).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Identify family members of degree n</span></span>
<span><span class="va">family_graphs</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_family_graphs.html">get_family_graphs</a></span><span class="op">(</span>pop_graph <span class="op">=</span> <span class="va">graph</span>,</span>
<span>                                  ndegree <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                  proband_vec <span class="op">=</span> <span class="va">pheno</span><span class="op">$</span><span class="va">id</span>,</span>
<span>                                  fid <span class="op">=</span> <span class="st">"fid"</span>,</span>
<span>                                  fam_graph_col <span class="op">=</span> <span class="st">"fam_graph"</span><span class="op">)</span></span>
<span><span class="va">family_graphs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 31 × 2</span></span></span>
<span><span class="co">#&gt;   fid   fam_graph</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> dad   <span style="color: #949494;">&lt;igraph&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> mom   <span style="color: #949494;">&lt;igraph&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> dad2  <span style="color: #949494;">&lt;igraph&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> mom2  <span style="color: #949494;">&lt;igraph&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 27 more rows</span></span></span></code></pre></div>
<p>The function <code><a href="../reference/get_family_graphs.html">get_family_graphs()</a></code> will return a formatted
tibble. The output will have two columns specified with the arguments,
<code>fid</code> and <code>fam_graph_col</code>. <code>fid</code> is the
ids of the provided probands, who are also the individuals the
neighbourhood (family) graphs are centred on. Note: In the example
above, we have only one family graph for a given proband, however, an
individual may still appear in several family graphs as a relative.
E.g., a parent with two children may appearing in the family graph of
both of their children. <code>fam_graph_col</code> holds the family
graphs and are in the format of igraph. Operations on this level will
not be required for the average user. An igraph object is shown here for
context:</p>
<p>TODO: add graph_to_trio to LTFGRS and plot a family graph to
illustrate the new pedigree.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">family_graphs</span><span class="op">$</span><span class="va">fam_graph</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; IGRAPH f3d8cee DN-- 8 17 -- </span></span>
<span><span class="co">#&gt; + attr: name (v/c)</span></span>
<span><span class="co">#&gt; + edges from f3d8cee (vertex names):</span></span>
<span><span class="co">#&gt;  [1] dad   -&gt;paunt  dad   -&gt;puncle dad   -&gt;sib    dad   -&gt;pid    dad   -&gt;phs   </span></span>
<span><span class="co">#&gt;  [6] pgf   -&gt;dad    pgf   -&gt;paunt  pgf   -&gt;puncle pgm   -&gt;dad    pgm   -&gt;paunt </span></span>
<span><span class="co">#&gt; [11] pgm   -&gt;puncle paunt -&gt;dad    paunt -&gt;puncle puncle-&gt;dad    puncle-&gt;paunt </span></span>
<span><span class="co">#&gt; [16] sib   -&gt;pid    pid   -&gt;sib</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="censoring-of-future-events-on-a-family-basis">Censoring of future events on a family basis<a class="anchor" aria-label="anchor" href="#censoring-of-future-events-on-a-family-basis"></a>
</h3>
<p>The purpose of the genetic liability estimated here is prediction. In
epidemiology (and many other fields) there is an emphasis on ensuring
future events are not used to base predictions on. Hence, we need to
ensure that, within a family, no events that happen after the end of
follow up of the proband is used to estimate the genetic liability of
the proband. In real world analysis, the end of follow up can be due to
the proband being diagnosed or any censoring event, such as end of
register follow up, emigration, or death. The function
<code><a href="../reference/censor_family_onsets_per_family.html">censor_family_onsets_per_family()</a></code> offers a way to censor
future events on a family basis, by censoring all events that happen
after the end of follow up of the proband (<code>indiv_eof</code>).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate family specific thresholds</span></span>
<span><span class="va">info</span> <span class="op">=</span> <span class="fu"><a href="../reference/censor_family_onsets_per_family.html">censor_family_onsets_per_family</a></span><span class="op">(</span></span>
<span>  family_graphs <span class="op">=</span> <span class="va">family_graphs</span>,</span>
<span>  tbl <span class="op">=</span> <span class="va">pheno</span>,</span>
<span>  start <span class="op">=</span> <span class="st">"fdato"</span>,</span>
<span>  end <span class="op">=</span> <span class="st">"indiv_eof"</span>,</span>
<span>  event <span class="op">=</span> <span class="st">"adhd"</span>,</span>
<span>  merge_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pid"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html" class="external-link">paged_table</a></span><span class="op">(</span><span class="va">info</span><span class="op">)</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["fid"],"name":[1],"type":["chr"],"align":["left"]},{"label":["pid"],"name":[2],"type":["chr"],"align":["left"]},{"label":["sex"],"name":[3],"type":["int"],"align":["right"]},{"label":["fdato"],"name":[4],"type":["date"],"align":["right"]},{"label":["birth_year"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["adhd"],"name":[6],"type":["date"],"align":["right"]},{"label":["indiv_eof"],"name":[7],"type":["date"],"align":["right"]},{"label":["status"],"name":[8],"type":["int"],"align":["right"]},{"label":["aod"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["age"],"name":[10],"type":["dbl"],"align":["right"]}],"data":[{"1":"dad","2":"dad","3":"0","4":"1957-09-16","5":"1957","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"53.289527721"},{"1":"dad","2":"pgf","3":"1","4":"2000-06-10","5":"2000","6":"2008-12-22","7":"2010-12-31","8":"1","9":"8.533881","10":"8.533880903"},{"1":"dad","2":"pgm","3":"1","4":"1998-09-13","5":"1998","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"12.298425736"},{"1":"dad","2":"paunt","3":"0","4":"1982-03-24","5":"1982","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"28.772073922"},{"1":"dad","2":"puncle","3":"0","4":"1991-02-13","5":"1991","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"19.879534565"},{"1":"dad","2":"sib","3":"1","4":"1969-11-11","5":"1969","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"41.136208077"},{"1":"dad","2":"pid","3":"1","4":"1958-10-17","5":"1958","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"52.205338809"},{"1":"dad","2":"phs","3":"0","4":"1987-06-01","5":"1987","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"23.583846680"},{"1":"mom","2":"mom","3":"0","4":"1957-09-17","5":"1957","6":"1969-11-08","7":"1969-11-08","8":"1","9":"12.142368","10":"12.142368241"},{"1":"mom","2":"mgf","3":"1","4":"1993-11-04","5":"1993","6":"2004-04-23","7":"1969-11-08","8":"0","9":"NA","10":"-23.989048597"},{"1":"mom","2":"mgm","3":"1","4":"1953-03-23","5":"1953","6":"<NA>","7":"1969-11-08","8":"0","9":"NA","10":"16.629705681"},{"1":"mom","2":"maunt","3":"0","4":"1956-10-04","5":"1956","6":"<NA>","7":"1969-11-08","8":"0","9":"NA","10":"13.095140315"},{"1":"mom","2":"sib","3":"1","4":"1969-11-11","5":"1969","6":"<NA>","7":"1969-11-08","8":"0","9":"NA","10":"-0.008213552"},{"1":"mom","2":"pid","3":"1","4":"1958-10-17","5":"1958","6":"<NA>","7":"1969-11-08","8":"0","9":"NA","10":"11.060917180"},{"1":"mom","2":"mhs","3":"0","4":"1958-11-21","5":"1958","6":"1991-03-02","7":"1969-11-08","8":"0","9":"NA","10":"10.965092402"},{"1":"dad2","2":"dad2","3":"1","4":"2000-01-27","5":"2000","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"10.926762491"},{"1":"dad2","2":"pgf2","3":"1","4":"1977-12-11","5":"1977","6":"2018-11-28","7":"2010-12-31","8":"0","9":"NA","10":"33.054072553"},{"1":"dad2","2":"pgm2","3":"0","4":"1994-11-16","5":"1994","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"16.123203285"},{"1":"dad2","2":"mhs","3":"0","4":"1958-11-21","5":"1958","6":"1991-03-02","7":"2010-12-31","8":"1","9":"32.276523","10":"32.276522930"},{"1":"mom2","2":"mom2","3":"1","4":"1978-08-17","5":"1978","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"32.372347707"},{"1":"mom2","2":"phs","3":"0","4":"1987-06-01","5":"1987","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"23.583846680"},{"1":"mgf","2":"mom","3":"0","4":"1957-09-17","5":"1957","6":"1969-11-08","7":"2004-04-23","8":"1","9":"12.142368","10":"12.142368241"},{"1":"mgf","2":"mgf","3":"1","4":"1993-11-04","5":"1993","6":"2004-04-23","7":"2004-04-23","8":"1","9":"10.466804","10":"10.466803559"},{"1":"mgf","2":"maunt","3":"0","4":"1956-10-04","5":"1956","6":"<NA>","7":"2004-04-23","8":"0","9":"NA","10":"47.550992471"},{"1":"mgf","2":"hsmuncle","3":"0","4":"1948-08-08","5":"1948","6":"2015-04-21","7":"2004-04-23","8":"0","9":"NA","10":"55.707049966"},{"1":"mgm","2":"mom","3":"0","4":"1957-09-17","5":"1957","6":"1969-11-08","7":"2010-12-31","8":"1","9":"12.142368","10":"12.142368241"},{"1":"mgm","2":"mgm","3":"1","4":"1953-03-23","5":"1953","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"57.774127310"},{"1":"mgm","2":"maunt","3":"0","4":"1956-10-04","5":"1956","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"54.239561944"},{"1":"pgf","2":"dad","3":"0","4":"1957-09-16","5":"1957","6":"<NA>","7":"2008-12-22","8":"0","9":"NA","10":"51.266255989"},{"1":"pgf","2":"pgf","3":"1","4":"2000-06-10","5":"2000","6":"2008-12-22","7":"2008-12-22","8":"1","9":"8.533881","10":"8.533880903"},{"1":"pgf","2":"paunt","3":"0","4":"1982-03-24","5":"1982","6":"<NA>","7":"2008-12-22","8":"0","9":"NA","10":"26.748802190"},{"1":"pgf","2":"puncle","3":"0","4":"1991-02-13","5":"1991","6":"<NA>","7":"2008-12-22","8":"0","9":"NA","10":"17.856262834"},{"1":"pgm","2":"dad","3":"0","4":"1957-09-16","5":"1957","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"53.289527721"},{"1":"pgm","2":"pgm","3":"1","4":"1998-09-13","5":"1998","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"12.298425736"},{"1":"pgm","2":"paunt","3":"0","4":"1982-03-24","5":"1982","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"28.772073922"},{"1":"pgm","2":"hspaunt","3":"0","4":"1973-12-09","5":"1973","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"37.059548255"},{"1":"pgm","2":"puncle","3":"0","4":"1991-02-13","5":"1991","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"19.879534565"},{"1":"pgf2","2":"dad2","3":"1","4":"2000-01-27","5":"2000","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"10.926762491"},{"1":"pgf2","2":"pgf2","3":"1","4":"1977-12-11","5":"1977","6":"2018-11-28","7":"2010-12-31","8":"0","9":"NA","10":"33.054072553"},{"1":"pgm2","2":"dad2","3":"1","4":"2000-01-27","5":"2000","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"10.926762491"},{"1":"pgm2","2":"pgm2","3":"0","4":"1994-11-16","5":"1994","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"16.123203285"},{"1":"pauntH","2":"pauntH","3":"1","4":"1997-11-05","5":"1997","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"13.152635181"},{"1":"pauntH","2":"pacousin","3":"0","4":"1984-02-23","5":"1984","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"26.852840520"},{"1":"paunt","2":"dad","3":"0","4":"1957-09-16","5":"1957","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"53.289527721"},{"1":"paunt","2":"pgf","3":"1","4":"2000-06-10","5":"2000","6":"2008-12-22","7":"2010-12-31","8":"1","9":"8.533881","10":"8.533880903"},{"1":"paunt","2":"pgm","3":"1","4":"1998-09-13","5":"1998","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"12.298425736"},{"1":"paunt","2":"paunt","3":"0","4":"1982-03-24","5":"1982","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"28.772073922"},{"1":"paunt","2":"puncle","3":"0","4":"1991-02-13","5":"1991","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"19.879534565"},{"1":"paunt","2":"pacousin","3":"0","4":"1984-02-23","5":"1984","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"26.852840520"},{"1":"newpgf","2":"newpgf","3":"1","4":"1976-05-22","5":"1976","6":"1979-12-16","7":"1979-12-16","8":"1","9":"3.567420","10":"3.567419576"},{"1":"newpgf","2":"hspaunt","3":"0","4":"1973-12-09","5":"1973","6":"<NA>","7":"1979-12-16","8":"0","9":"NA","10":"6.017796030"},{"1":"hspauntH","2":"hspauntH","3":"0","4":"1998-05-13","5":"1998","6":"2000-07-09","7":"2000-07-09","8":"1","9":"2.157426","10":"2.157426420"},{"1":"hspauntH","2":"hspacousin","3":"1","4":"1975-11-18","5":"1975","6":"2018-09-18","7":"2000-07-09","8":"0","9":"NA","10":"24.640657084"},{"1":"hspaunt","2":"pgm","3":"1","4":"1998-09-13","5":"1998","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"12.298425736"},{"1":"hspaunt","2":"newpgf","3":"1","4":"1976-05-22","5":"1976","6":"1979-12-16","7":"2010-12-31","8":"1","9":"3.567420","10":"3.567419576"},{"1":"hspaunt","2":"hspaunt","3":"0","4":"1973-12-09","5":"1973","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"37.059548255"},{"1":"hspaunt","2":"hspacousin","3":"1","4":"1975-11-18","5":"1975","6":"2018-09-18","7":"2010-12-31","8":"0","9":"NA","10":"35.118412047"},{"1":"puncle","2":"dad","3":"0","4":"1957-09-16","5":"1957","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"53.289527721"},{"1":"puncle","2":"pgf","3":"1","4":"2000-06-10","5":"2000","6":"2008-12-22","7":"2010-12-31","8":"1","9":"8.533881","10":"8.533880903"},{"1":"puncle","2":"pgm","3":"1","4":"1998-09-13","5":"1998","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"12.298425736"},{"1":"puncle","2":"paunt","3":"0","4":"1982-03-24","5":"1982","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"28.772073922"},{"1":"puncle","2":"puncle","3":"0","4":"1991-02-13","5":"1991","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"19.879534565"},{"1":"puncle","2":"pucousin","3":"1","4":"1995-03-01","5":"1995","6":"2019-05-09","7":"2010-12-31","8":"0","9":"NA","10":"15.835728953"},{"1":"puncleW","2":"puncleW","3":"1","4":"1997-09-16","5":"1997","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"13.289527721"},{"1":"puncleW","2":"pucousin","3":"1","4":"1995-03-01","5":"1995","6":"2019-05-09","7":"2010-12-31","8":"0","9":"NA","10":"15.835728953"},{"1":"mauntH","2":"mauntH","3":"0","4":"1995-10-10","5":"1995","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"15.225188227"},{"1":"mauntH","2":"macousin","3":"1","4":"1949-06-16","5":"1949","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"61.541409993"},{"1":"maunt","2":"mom","3":"0","4":"1957-09-17","5":"1957","6":"1969-11-08","7":"2010-12-31","8":"1","9":"12.142368","10":"12.142368241"},{"1":"maunt","2":"mgf","3":"1","4":"1993-11-04","5":"1993","6":"2004-04-23","7":"2010-12-31","8":"1","9":"10.466804","10":"10.466803559"},{"1":"maunt","2":"mgm","3":"1","4":"1953-03-23","5":"1953","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"57.774127310"},{"1":"maunt","2":"maunt","3":"0","4":"1956-10-04","5":"1956","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"54.239561944"},{"1":"maunt","2":"macousin","3":"1","4":"1949-06-16","5":"1949","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"61.541409993"},{"1":"newmgm","2":"newmgm","3":"0","4":"1945-06-17","5":"1945","6":"1970-09-26","7":"1970-09-26","8":"1","9":"25.275838","10":"25.275838467"},{"1":"newmgm","2":"hsmuncle","3":"0","4":"1948-08-08","5":"1948","6":"2015-04-21","7":"1970-09-26","8":"0","9":"NA","10":"22.132785763"},{"1":"hsmuncle","2":"mgf","3":"1","4":"1993-11-04","5":"1993","6":"2004-04-23","7":"2010-12-31","8":"1","9":"10.466804","10":"10.466803559"},{"1":"hsmuncle","2":"newmgm","3":"0","4":"1945-06-17","5":"1945","6":"1970-09-26","7":"2010-12-31","8":"1","9":"25.275838","10":"25.275838467"},{"1":"hsmuncle","2":"hsmuncle","3":"0","4":"1948-08-08","5":"1948","6":"2015-04-21","7":"2010-12-31","8":"0","9":"NA","10":"62.395619439"},{"1":"hsmuncle","2":"hsmucousin","3":"0","4":"1996-05-03","5":"1996","6":"2008-11-09","7":"2010-12-31","8":"1","9":"12.520192","10":"12.520191650"},{"1":"hsmuncleW","2":"hsmuncleW","3":"0","4":"1961-04-17","5":"1961","6":"1972-11-07","7":"1972-11-07","8":"1","9":"11.559206","10":"11.559206023"},{"1":"hsmuncleW","2":"hsmucousin","3":"0","4":"1996-05-03","5":"1996","6":"2008-11-09","7":"1972-11-07","8":"0","9":"NA","10":"-23.485284052"},{"1":"sib","2":"dad","3":"0","4":"1957-09-16","5":"1957","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"53.289527721"},{"1":"sib","2":"mom","3":"0","4":"1957-09-17","5":"1957","6":"1969-11-08","7":"2010-12-31","8":"1","9":"12.142368","10":"12.142368241"},{"1":"sib","2":"sib","3":"1","4":"1969-11-11","5":"1969","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"41.136208077"},{"1":"sib","2":"pid","3":"1","4":"1958-10-17","5":"1958","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"52.205338809"},{"1":"pid","2":"dad","3":"0","4":"1957-09-16","5":"1957","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"53.289527721"},{"1":"pid","2":"mom","3":"0","4":"1957-09-17","5":"1957","6":"1969-11-08","7":"2010-12-31","8":"1","9":"12.142368","10":"12.142368241"},{"1":"pid","2":"sib","3":"1","4":"1969-11-11","5":"1969","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"41.136208077"},{"1":"pid","2":"pid","3":"1","4":"1958-10-17","5":"1958","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"52.205338809"},{"1":"mhs","2":"mom","3":"0","4":"1957-09-17","5":"1957","6":"1969-11-08","7":"1991-03-02","8":"1","9":"12.142368","10":"12.142368241"},{"1":"mhs","2":"dad2","3":"1","4":"2000-01-27","5":"2000","6":"<NA>","7":"1991-03-02","8":"0","9":"NA","10":"-8.906228611"},{"1":"mhs","2":"mhs","3":"0","4":"1958-11-21","5":"1958","6":"1991-03-02","7":"1991-03-02","8":"1","9":"32.276523","10":"32.276522930"},{"1":"phs","2":"dad","3":"0","4":"1957-09-16","5":"1957","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"53.289527721"},{"1":"phs","2":"mom2","3":"1","4":"1978-08-17","5":"1978","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"32.372347707"},{"1":"phs","2":"phs","3":"0","4":"1987-06-01","5":"1987","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"23.583846680"},{"1":"pacousin","2":"pauntH","3":"1","4":"1997-11-05","5":"1997","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"13.152635181"},{"1":"pacousin","2":"paunt","3":"0","4":"1982-03-24","5":"1982","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"28.772073922"},{"1":"pacousin","2":"pacousin","3":"0","4":"1984-02-23","5":"1984","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"26.852840520"},{"1":"hspacousin","2":"hspauntH","3":"0","4":"1998-05-13","5":"1998","6":"2000-07-09","7":"2010-12-31","8":"1","9":"2.157426","10":"2.157426420"},{"1":"hspacousin","2":"hspaunt","3":"0","4":"1973-12-09","5":"1973","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"37.059548255"},{"1":"hspacousin","2":"hspacousin","3":"1","4":"1975-11-18","5":"1975","6":"2018-09-18","7":"2010-12-31","8":"0","9":"NA","10":"35.118412047"},{"1":"pucousin","2":"puncle","3":"0","4":"1991-02-13","5":"1991","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"19.879534565"},{"1":"pucousin","2":"puncleW","3":"1","4":"1997-09-16","5":"1997","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"13.289527721"},{"1":"pucousin","2":"pucousin","3":"1","4":"1995-03-01","5":"1995","6":"2019-05-09","7":"2010-12-31","8":"0","9":"NA","10":"15.835728953"},{"1":"macousin","2":"mauntH","3":"0","4":"1995-10-10","5":"1995","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"15.225188227"},{"1":"macousin","2":"maunt","3":"0","4":"1956-10-04","5":"1956","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"54.239561944"},{"1":"macousin","2":"macousin","3":"1","4":"1949-06-16","5":"1949","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"61.541409993"},{"1":"hsmucousin","2":"hsmuncle","3":"0","4":"1948-08-08","5":"1948","6":"2015-04-21","7":"2008-11-09","8":"0","9":"NA","10":"60.254620123"},{"1":"hsmucousin","2":"hsmuncleW","3":"0","4":"1961-04-17","5":"1961","6":"1972-11-07","7":"2008-11-09","8":"1","9":"11.559206","10":"11.559206023"},{"1":"hsmucousin","2":"hsmucousin","3":"0","4":"1996-05-03","5":"1996","6":"2008-11-09","7":"2008-11-09","8":"1","9":"12.520192","10":"12.520191650"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The function <code><a href="../reference/censor_family_onsets_per_family.html">censor_family_onsets_per_family()</a></code> will
return a tibble with the following additional columns:</p>
<ul>
<li>
<code>status</code>: Assigned case-control status based on the
family-wise censoring time, i.e. if the event happened after the end of
follow up of the family, the status is set to <code>FALSE</code>
(0).</li>
<li>
<code>aod</code>: The age of diagnosis, NA for controls.</li>
<li>
<code>age</code>: The age at the end of the family-wise follow
up.</li>
</ul>
<p>The above information is used to calculate the personalised
thresholds for each individual while also accounting for the fact that
each family may have differing levels of information available to
them.</p>
</div>
<div class="section level3">
<h3 id="assign-thresholds-to-censored-families">Assign thresholds to censored families<a class="anchor" aria-label="anchor" href="#assign-thresholds-to-censored-families"></a>
</h3>
<p>Once the <code>status</code>, <code>aod</code>, and <code>age</code>
are known, we can assign thresholds to each family and their family
members. Notably, this means that if an individual appears in multiple
families, e.g. as a proband and as a relative to a different proband,
that individual may have multiple (potentially different) thresholds
assigned to them. The use of <code>fid</code> and <code>pid</code> helps
ensure that each individual can still be uniquely identified. Due to
data privacy, it is possible to encounter CIPs values that are only
provided at set values, e.g. a CIP value for each whole year by birth
year and sex, such as what is shown in with the <code>CIP</code> object.
However, the observed ages (or age of diagnosis) are typically not
integer values. This means we may need to approximate the CIP values
between the provided values. We offer an XGboost based approach to
interpolate the CIPs between the provided values.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fam_thrs</span> <span class="op">=</span> <span class="fu"><a href="../reference/prepare_LTFHPlus_input.html">prepare_LTFHPlus_input</a></span><span class="op">(</span></span>
<span>  .tbl <span class="op">=</span> <span class="va">info</span>,</span>
<span>  CIP <span class="op">=</span> <span class="va">CIP</span>,</span>
<span>  age_col <span class="op">=</span> <span class="st">"age"</span> ,</span>
<span>  use_fixed_case_thr <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  personal_thr <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>  fam_id_col <span class="op">=</span> <span class="st">"fid"</span>,</span>
<span>  personal_id_col <span class="op">=</span> <span class="st">"pid"</span>,</span>
<span>  interpolation <span class="op">=</span> <span class="st">"xgboost"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html" class="external-link">paged_table</a></span><span class="op">(</span><span class="va">fam_thrs</span><span class="op">)</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["fid"],"name":[1],"type":["chr"],"align":["left"]},{"label":["pid"],"name":[2],"type":["chr"],"align":["left"]},{"label":["sex"],"name":[3],"type":["int"],"align":["right"]},{"label":["fdato"],"name":[4],"type":["date"],"align":["right"]},{"label":["birth_year"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["adhd"],"name":[6],"type":["date"],"align":["right"]},{"label":["indiv_eof"],"name":[7],"type":["date"],"align":["right"]},{"label":["status"],"name":[8],"type":["int"],"align":["right"]},{"label":["aod"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["age"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["K_i"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["K_pop"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["thr"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["lower"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["upper"],"name":[15],"type":["dbl"],"align":["right"]}],"data":[{"1":"mom","2":"mgf","3":"1","4":"1993-11-04","5":"1993","6":"2004-04-23","7":"1969-11-08","8":"0","9":"NA","10":"-23.989048597","11":"4.880407e-05","12":"0.297","13":"3.8964619","14":"-Inf","15":"3.8964619"},{"1":"hsmuncleW","2":"hsmucousin","3":"0","4":"1996-05-03","5":"1996","6":"2008-11-09","7":"1972-11-07","8":"0","9":"NA","10":"-23.485284052","11":"4.880407e-05","12":"0.297","13":"3.8964619","14":"-Inf","15":"3.8964619"},{"1":"mhs","2":"dad2","3":"1","4":"2000-01-27","5":"2000","6":"<NA>","7":"1991-03-02","8":"0","9":"NA","10":"-8.906228611","11":"4.880407e-05","12":"0.297","13":"3.8964619","14":"-Inf","15":"3.8964619"},{"1":"mom","2":"sib","3":"1","4":"1969-11-11","5":"1969","6":"<NA>","7":"1969-11-08","8":"0","9":"NA","10":"-0.008213552","11":"4.880407e-05","12":"0.297","13":"3.8964619","14":"-Inf","15":"3.8964619"},{"1":"hspauntH","2":"hspauntH","3":"0","4":"1998-05-13","5":"1998","6":"2000-07-09","7":"2000-07-09","8":"1","9":"2.157426","10":"2.157426420","11":"3.022709e-03","12":"0.297","13":"2.7453078","14":"2.745308","15":"Inf"},{"1":"hspacousin","2":"hspauntH","3":"0","4":"1998-05-13","5":"1998","6":"2000-07-09","7":"2010-12-31","8":"1","9":"2.157426","10":"2.157426420","11":"3.022709e-03","12":"0.297","13":"2.7453078","14":"2.745308","15":"Inf"},{"1":"newpgf","2":"newpgf","3":"1","4":"1976-05-22","5":"1976","6":"1979-12-16","7":"1979-12-16","8":"1","9":"3.567420","10":"3.567419576","11":"9.012269e-03","12":"0.297","13":"2.3651137","14":"2.365114","15":"Inf"},{"1":"hspaunt","2":"newpgf","3":"1","4":"1976-05-22","5":"1976","6":"1979-12-16","7":"2010-12-31","8":"1","9":"3.567420","10":"3.567419576","11":"9.012269e-03","12":"0.297","13":"2.3651137","14":"2.365114","15":"Inf"},{"1":"newpgf","2":"hspaunt","3":"0","4":"1973-12-09","5":"1973","6":"<NA>","7":"1979-12-16","8":"0","9":"NA","10":"6.017796030","11":"1.500740e-02","12":"0.297","13":"2.1698950","14":"-Inf","15":"2.1698950"},{"1":"dad","2":"pgf","3":"1","4":"2000-06-10","5":"2000","6":"2008-12-22","7":"2010-12-31","8":"1","9":"8.533881","10":"8.533880903","11":"2.401240e-02","12":"0.297","13":"1.9771489","14":"1.977149","15":"Inf"},{"1":"pgf","2":"pgf","3":"1","4":"2000-06-10","5":"2000","6":"2008-12-22","7":"2008-12-22","8":"1","9":"8.533881","10":"8.533880903","11":"2.401240e-02","12":"0.297","13":"1.9771489","14":"1.977149","15":"Inf"},{"1":"paunt","2":"pgf","3":"1","4":"2000-06-10","5":"2000","6":"2008-12-22","7":"2010-12-31","8":"1","9":"8.533881","10":"8.533880903","11":"2.401240e-02","12":"0.297","13":"1.9771489","14":"1.977149","15":"Inf"},{"1":"puncle","2":"pgf","3":"1","4":"2000-06-10","5":"2000","6":"2008-12-22","7":"2010-12-31","8":"1","9":"8.533881","10":"8.533880903","11":"2.401240e-02","12":"0.297","13":"1.9771489","14":"1.977149","15":"Inf"},{"1":"mgf","2":"mgf","3":"1","4":"1993-11-04","5":"1993","6":"2004-04-23","7":"2004-04-23","8":"1","9":"10.466804","10":"10.466803559","11":"2.700865e-02","12":"0.297","13":"1.9266979","14":"1.926698","15":"Inf"},{"1":"maunt","2":"mgf","3":"1","4":"1993-11-04","5":"1993","6":"2004-04-23","7":"2010-12-31","8":"1","9":"10.466804","10":"10.466803559","11":"2.700865e-02","12":"0.297","13":"1.9266979","14":"1.926698","15":"Inf"},{"1":"hsmuncle","2":"mgf","3":"1","4":"1993-11-04","5":"1993","6":"2004-04-23","7":"2010-12-31","8":"1","9":"10.466804","10":"10.466803559","11":"2.700865e-02","12":"0.297","13":"1.9266979","14":"1.926698","15":"Inf"},{"1":"dad2","2":"dad2","3":"1","4":"2000-01-27","5":"2000","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"10.926762491","11":"3.000283e-02","12":"0.297","13":"1.8807520","14":"-Inf","15":"1.8807520"},{"1":"pgf2","2":"dad2","3":"1","4":"2000-01-27","5":"2000","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"10.926762491","11":"3.000283e-02","12":"0.297","13":"1.8807520","14":"-Inf","15":"1.8807520"},{"1":"pgm2","2":"dad2","3":"1","4":"2000-01-27","5":"2000","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"10.926762491","11":"3.000283e-02","12":"0.297","13":"1.8807520","14":"-Inf","15":"1.8807520"},{"1":"mom","2":"mhs","3":"0","4":"1958-11-21","5":"1958","6":"1991-03-02","7":"1969-11-08","8":"0","9":"NA","10":"10.965092402","11":"3.000283e-02","12":"0.297","13":"1.8807520","14":"-Inf","15":"1.8807520"},{"1":"mom","2":"pid","3":"1","4":"1958-10-17","5":"1958","6":"<NA>","7":"1969-11-08","8":"0","9":"NA","10":"11.060917180","11":"3.000283e-02","12":"0.297","13":"1.8807520","14":"-Inf","15":"1.8807520"},{"1":"hsmuncleW","2":"hsmuncleW","3":"0","4":"1961-04-17","5":"1961","6":"1972-11-07","7":"1972-11-07","8":"1","9":"11.559206","10":"11.559206023","11":"3.300472e-02","12":"0.297","13":"1.8383595","14":"1.838360","15":"Inf"},{"1":"hsmucousin","2":"hsmuncleW","3":"0","4":"1961-04-17","5":"1961","6":"1972-11-07","7":"2008-11-09","8":"1","9":"11.559206","10":"11.559206023","11":"3.300472e-02","12":"0.297","13":"1.8383595","14":"1.838360","15":"Inf"},{"1":"mom","2":"mom","3":"0","4":"1957-09-17","5":"1957","6":"1969-11-08","7":"1969-11-08","8":"1","9":"12.142368","10":"12.142368241","11":"3.300472e-02","12":"0.297","13":"1.8383595","14":"1.838360","15":"Inf"},{"1":"mgf","2":"mom","3":"0","4":"1957-09-17","5":"1957","6":"1969-11-08","7":"2004-04-23","8":"1","9":"12.142368","10":"12.142368241","11":"3.300472e-02","12":"0.297","13":"1.8383595","14":"1.838360","15":"Inf"},{"1":"mgm","2":"mom","3":"0","4":"1957-09-17","5":"1957","6":"1969-11-08","7":"2010-12-31","8":"1","9":"12.142368","10":"12.142368241","11":"3.300472e-02","12":"0.297","13":"1.8383595","14":"1.838360","15":"Inf"},{"1":"maunt","2":"mom","3":"0","4":"1957-09-17","5":"1957","6":"1969-11-08","7":"2010-12-31","8":"1","9":"12.142368","10":"12.142368241","11":"3.300472e-02","12":"0.297","13":"1.8383595","14":"1.838360","15":"Inf"},{"1":"sib","2":"mom","3":"0","4":"1957-09-17","5":"1957","6":"1969-11-08","7":"2010-12-31","8":"1","9":"12.142368","10":"12.142368241","11":"3.300472e-02","12":"0.297","13":"1.8383595","14":"1.838360","15":"Inf"},{"1":"pid","2":"mom","3":"0","4":"1957-09-17","5":"1957","6":"1969-11-08","7":"2010-12-31","8":"1","9":"12.142368","10":"12.142368241","11":"3.300472e-02","12":"0.297","13":"1.8383595","14":"1.838360","15":"Inf"},{"1":"mhs","2":"mom","3":"0","4":"1957-09-17","5":"1957","6":"1969-11-08","7":"1991-03-02","8":"1","9":"12.142368","10":"12.142368241","11":"3.300472e-02","12":"0.297","13":"1.8383595","14":"1.838360","15":"Inf"},{"1":"dad","2":"pgm","3":"1","4":"1998-09-13","5":"1998","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"12.298425736","11":"3.300472e-02","12":"0.297","13":"1.8383595","14":"-Inf","15":"1.8383595"},{"1":"pgm","2":"pgm","3":"1","4":"1998-09-13","5":"1998","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"12.298425736","11":"3.300472e-02","12":"0.297","13":"1.8383595","14":"-Inf","15":"1.8383595"},{"1":"paunt","2":"pgm","3":"1","4":"1998-09-13","5":"1998","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"12.298425736","11":"3.300472e-02","12":"0.297","13":"1.8383595","14":"-Inf","15":"1.8383595"},{"1":"hspaunt","2":"pgm","3":"1","4":"1998-09-13","5":"1998","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"12.298425736","11":"3.300472e-02","12":"0.297","13":"1.8383595","14":"-Inf","15":"1.8383595"},{"1":"puncle","2":"pgm","3":"1","4":"1998-09-13","5":"1998","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"12.298425736","11":"3.300472e-02","12":"0.297","13":"1.8383595","14":"-Inf","15":"1.8383595"},{"1":"hsmuncle","2":"hsmucousin","3":"0","4":"1996-05-03","5":"1996","6":"2008-11-09","7":"2010-12-31","8":"1","9":"12.520192","10":"12.520191650","11":"3.599665e-02","12":"0.297","13":"1.7991604","14":"1.799160","15":"Inf"},{"1":"hsmucousin","2":"hsmucousin","3":"0","4":"1996-05-03","5":"1996","6":"2008-11-09","7":"2008-11-09","8":"1","9":"12.520192","10":"12.520191650","11":"3.599665e-02","12":"0.297","13":"1.7991604","14":"1.799160","15":"Inf"},{"1":"mom","2":"maunt","3":"0","4":"1956-10-04","5":"1956","6":"<NA>","7":"1969-11-08","8":"0","9":"NA","10":"13.095140315","11":"3.599665e-02","12":"0.297","13":"1.7991604","14":"-Inf","15":"1.7991604"},{"1":"pauntH","2":"pauntH","3":"1","4":"1997-11-05","5":"1997","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"13.152635181","11":"3.599665e-02","12":"0.297","13":"1.7991604","14":"-Inf","15":"1.7991604"},{"1":"pacousin","2":"pauntH","3":"1","4":"1997-11-05","5":"1997","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"13.152635181","11":"3.599665e-02","12":"0.297","13":"1.7991604","14":"-Inf","15":"1.7991604"},{"1":"puncleW","2":"puncleW","3":"1","4":"1997-09-16","5":"1997","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"13.289527721","11":"3.599665e-02","12":"0.297","13":"1.7991604","14":"-Inf","15":"1.7991604"},{"1":"pucousin","2":"puncleW","3":"1","4":"1997-09-16","5":"1997","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"13.289527721","11":"3.599665e-02","12":"0.297","13":"1.7991604","14":"-Inf","15":"1.7991604"},{"1":"mauntH","2":"mauntH","3":"0","4":"1995-10-10","5":"1995","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"15.225188227","11":"4.200790e-02","12":"0.297","13":"1.7278462","14":"-Inf","15":"1.7278462"},{"1":"macousin","2":"mauntH","3":"0","4":"1995-10-10","5":"1995","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"15.225188227","11":"4.200790e-02","12":"0.297","13":"1.7278462","14":"-Inf","15":"1.7278462"},{"1":"puncle","2":"pucousin","3":"1","4":"1995-03-01","5":"1995","6":"2019-05-09","7":"2010-12-31","8":"0","9":"NA","10":"15.835728953","11":"4.499768e-02","12":"0.297","13":"1.6954222","14":"-Inf","15":"1.6954222"},{"1":"puncleW","2":"pucousin","3":"1","4":"1995-03-01","5":"1995","6":"2019-05-09","7":"2010-12-31","8":"0","9":"NA","10":"15.835728953","11":"4.499768e-02","12":"0.297","13":"1.6954222","14":"-Inf","15":"1.6954222"},{"1":"pucousin","2":"pucousin","3":"1","4":"1995-03-01","5":"1995","6":"2019-05-09","7":"2010-12-31","8":"0","9":"NA","10":"15.835728953","11":"4.499768e-02","12":"0.297","13":"1.6954222","14":"-Inf","15":"1.6954222"},{"1":"dad2","2":"pgm2","3":"0","4":"1994-11-16","5":"1994","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"16.123203285","11":"4.499768e-02","12":"0.297","13":"1.6954222","14":"-Inf","15":"1.6954222"},{"1":"pgm2","2":"pgm2","3":"0","4":"1994-11-16","5":"1994","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"16.123203285","11":"4.499768e-02","12":"0.297","13":"1.6954222","14":"-Inf","15":"1.6954222"},{"1":"mom","2":"mgm","3":"1","4":"1953-03-23","5":"1953","6":"<NA>","7":"1969-11-08","8":"0","9":"NA","10":"16.629705681","11":"4.799923e-02","12":"0.297","13":"1.6645706","14":"-Inf","15":"1.6645706"},{"1":"pgf","2":"puncle","3":"0","4":"1991-02-13","5":"1991","6":"<NA>","7":"2008-12-22","8":"0","9":"NA","10":"17.856262834","11":"5.100003e-02","12":"0.297","13":"1.6352337","14":"-Inf","15":"1.6352337"},{"1":"dad","2":"puncle","3":"0","4":"1991-02-13","5":"1991","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"19.879534565","11":"5.699626e-02","12":"0.297","13":"1.5804995","14":"-Inf","15":"1.5804995"},{"1":"pgm","2":"puncle","3":"0","4":"1991-02-13","5":"1991","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"19.879534565","11":"5.699626e-02","12":"0.297","13":"1.5804995","14":"-Inf","15":"1.5804995"},{"1":"paunt","2":"puncle","3":"0","4":"1991-02-13","5":"1991","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"19.879534565","11":"5.699626e-02","12":"0.297","13":"1.5804995","14":"-Inf","15":"1.5804995"},{"1":"puncle","2":"puncle","3":"0","4":"1991-02-13","5":"1991","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"19.879534565","11":"5.699626e-02","12":"0.297","13":"1.5804995","14":"-Inf","15":"1.5804995"},{"1":"pucousin","2":"puncle","3":"0","4":"1991-02-13","5":"1991","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"19.879534565","11":"5.699626e-02","12":"0.297","13":"1.5804995","14":"-Inf","15":"1.5804995"},{"1":"newmgm","2":"hsmuncle","3":"0","4":"1948-08-08","5":"1948","6":"2015-04-21","7":"1970-09-26","8":"0","9":"NA","10":"22.132785763","11":"6.300569e-02","12":"0.297","13":"1.5300216","14":"-Inf","15":"1.5300216"},{"1":"dad","2":"phs","3":"0","4":"1987-06-01","5":"1987","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"23.583846680","11":"6.900066e-02","12":"0.297","13":"1.4832751","14":"-Inf","15":"1.4832751"},{"1":"mom2","2":"phs","3":"0","4":"1987-06-01","5":"1987","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"23.583846680","11":"6.900066e-02","12":"0.297","13":"1.4832751","14":"-Inf","15":"1.4832751"},{"1":"phs","2":"phs","3":"0","4":"1987-06-01","5":"1987","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"23.583846680","11":"6.900066e-02","12":"0.297","13":"1.4832751","14":"-Inf","15":"1.4832751"},{"1":"hspauntH","2":"hspacousin","3":"1","4":"1975-11-18","5":"1975","6":"2018-09-18","7":"2000-07-09","8":"0","9":"NA","10":"24.640657084","11":"7.200011e-02","12":"0.297","13":"1.4610555","14":"-Inf","15":"1.4610555"},{"1":"newmgm","2":"newmgm","3":"0","4":"1945-06-17","5":"1945","6":"1970-09-26","7":"1970-09-26","8":"1","9":"25.275838","10":"25.275838467","11":"7.200011e-02","12":"0.297","13":"1.4610555","14":"1.461055","15":"Inf"},{"1":"hsmuncle","2":"newmgm","3":"0","4":"1945-06-17","5":"1945","6":"1970-09-26","7":"2010-12-31","8":"1","9":"25.275838","10":"25.275838467","11":"7.200011e-02","12":"0.297","13":"1.4610555","14":"1.461055","15":"Inf"},{"1":"pgf","2":"paunt","3":"0","4":"1982-03-24","5":"1982","6":"<NA>","7":"2008-12-22","8":"0","9":"NA","10":"26.748802190","11":"7.799947e-02","12":"0.297","13":"1.4186573","14":"-Inf","15":"1.4186573"},{"1":"pauntH","2":"pacousin","3":"0","4":"1984-02-23","5":"1984","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"26.852840520","11":"7.799947e-02","12":"0.297","13":"1.4186573","14":"-Inf","15":"1.4186573"},{"1":"paunt","2":"pacousin","3":"0","4":"1984-02-23","5":"1984","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"26.852840520","11":"7.799947e-02","12":"0.297","13":"1.4186573","14":"-Inf","15":"1.4186573"},{"1":"pacousin","2":"pacousin","3":"0","4":"1984-02-23","5":"1984","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"26.852840520","11":"7.799947e-02","12":"0.297","13":"1.4186573","14":"-Inf","15":"1.4186573"},{"1":"dad","2":"paunt","3":"0","4":"1982-03-24","5":"1982","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"28.772073922","11":"8.400605e-02","12":"0.297","13":"1.3786195","14":"-Inf","15":"1.3786195"},{"1":"pgm","2":"paunt","3":"0","4":"1982-03-24","5":"1982","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"28.772073922","11":"8.400605e-02","12":"0.297","13":"1.3786195","14":"-Inf","15":"1.3786195"},{"1":"paunt","2":"paunt","3":"0","4":"1982-03-24","5":"1982","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"28.772073922","11":"8.400605e-02","12":"0.297","13":"1.3786195","14":"-Inf","15":"1.3786195"},{"1":"puncle","2":"paunt","3":"0","4":"1982-03-24","5":"1982","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"28.772073922","11":"8.400605e-02","12":"0.297","13":"1.3786195","14":"-Inf","15":"1.3786195"},{"1":"pacousin","2":"paunt","3":"0","4":"1982-03-24","5":"1982","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"28.772073922","11":"8.400605e-02","12":"0.297","13":"1.3786195","14":"-Inf","15":"1.3786195"},{"1":"dad2","2":"mhs","3":"0","4":"1958-11-21","5":"1958","6":"1991-03-02","7":"2010-12-31","8":"1","9":"32.276523","10":"32.276522930","11":"9.300523e-02","12":"0.297","13":"1.3224737","14":"1.322474","15":"Inf"},{"1":"mhs","2":"mhs","3":"0","4":"1958-11-21","5":"1958","6":"1991-03-02","7":"1991-03-02","8":"1","9":"32.276523","10":"32.276522930","11":"9.300523e-02","12":"0.297","13":"1.3224737","14":"1.322474","15":"Inf"},{"1":"mom2","2":"mom2","3":"1","4":"1978-08-17","5":"1978","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"32.372347707","11":"9.300523e-02","12":"0.297","13":"1.3224737","14":"-Inf","15":"1.3224737"},{"1":"phs","2":"mom2","3":"1","4":"1978-08-17","5":"1978","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"32.372347707","11":"9.300523e-02","12":"0.297","13":"1.3224737","14":"-Inf","15":"1.3224737"},{"1":"dad2","2":"pgf2","3":"1","4":"1977-12-11","5":"1977","6":"2018-11-28","7":"2010-12-31","8":"0","9":"NA","10":"33.054072553","11":"9.599962e-02","12":"0.297","13":"1.3046876","14":"-Inf","15":"1.3046876"},{"1":"pgf2","2":"pgf2","3":"1","4":"1977-12-11","5":"1977","6":"2018-11-28","7":"2010-12-31","8":"0","9":"NA","10":"33.054072553","11":"9.599962e-02","12":"0.297","13":"1.3046876","14":"-Inf","15":"1.3046876"},{"1":"hspaunt","2":"hspacousin","3":"1","4":"1975-11-18","5":"1975","6":"2018-09-18","7":"2010-12-31","8":"0","9":"NA","10":"35.118412047","11":"1.020009e-01","12":"0.297","13":"1.2702323","14":"-Inf","15":"1.2702323"},{"1":"hspacousin","2":"hspacousin","3":"1","4":"1975-11-18","5":"1975","6":"2018-09-18","7":"2010-12-31","8":"0","9":"NA","10":"35.118412047","11":"1.020009e-01","12":"0.297","13":"1.2702323","14":"-Inf","15":"1.2702323"},{"1":"pgm","2":"hspaunt","3":"0","4":"1973-12-09","5":"1973","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"37.059548255","11":"1.079974e-01","12":"0.297","13":"1.2372484","14":"-Inf","15":"1.2372484"},{"1":"hspaunt","2":"hspaunt","3":"0","4":"1973-12-09","5":"1973","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"37.059548255","11":"1.079974e-01","12":"0.297","13":"1.2372484","14":"-Inf","15":"1.2372484"},{"1":"hspacousin","2":"hspaunt","3":"0","4":"1973-12-09","5":"1973","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"37.059548255","11":"1.079974e-01","12":"0.297","13":"1.2372484","14":"-Inf","15":"1.2372484"},{"1":"dad","2":"sib","3":"1","4":"1969-11-11","5":"1969","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"41.136208077","11":"1.199973e-01","12":"0.297","13":"1.1750005","14":"-Inf","15":"1.1750005"},{"1":"sib","2":"sib","3":"1","4":"1969-11-11","5":"1969","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"41.136208077","11":"1.199973e-01","12":"0.297","13":"1.1750005","14":"-Inf","15":"1.1750005"},{"1":"pid","2":"sib","3":"1","4":"1969-11-11","5":"1969","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"41.136208077","11":"1.199973e-01","12":"0.297","13":"1.1750005","14":"-Inf","15":"1.1750005"},{"1":"mgf","2":"maunt","3":"0","4":"1956-10-04","5":"1956","6":"<NA>","7":"2004-04-23","8":"0","9":"NA","10":"47.550992471","11":"1.410013e-01","12":"0.297","13":"1.0758317","14":"-Inf","15":"1.0758317"},{"1":"pgf","2":"dad","3":"0","4":"1957-09-16","5":"1957","6":"<NA>","7":"2008-12-22","8":"0","9":"NA","10":"51.266255989","11":"1.500635e-01","12":"0.297","13":"1.0361612","14":"-Inf","15":"1.0361612"},{"1":"dad","2":"pid","3":"1","4":"1958-10-17","5":"1958","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"52.205338809","11":"1.530011e-01","12":"0.297","13":"1.0236467","14":"-Inf","15":"1.0236467"},{"1":"sib","2":"pid","3":"1","4":"1958-10-17","5":"1958","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"52.205338809","11":"1.530011e-01","12":"0.297","13":"1.0236467","14":"-Inf","15":"1.0236467"},{"1":"pid","2":"pid","3":"1","4":"1958-10-17","5":"1958","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"52.205338809","11":"1.530011e-01","12":"0.297","13":"1.0236467","14":"-Inf","15":"1.0236467"},{"1":"dad","2":"dad","3":"0","4":"1957-09-16","5":"1957","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"53.289527721","11":"1.559971e-01","12":"0.297","13":"1.0110466","14":"-Inf","15":"1.0110466"},{"1":"pgm","2":"dad","3":"0","4":"1957-09-16","5":"1957","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"53.289527721","11":"1.559971e-01","12":"0.297","13":"1.0110466","14":"-Inf","15":"1.0110466"},{"1":"paunt","2":"dad","3":"0","4":"1957-09-16","5":"1957","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"53.289527721","11":"1.559971e-01","12":"0.297","13":"1.0110466","14":"-Inf","15":"1.0110466"},{"1":"puncle","2":"dad","3":"0","4":"1957-09-16","5":"1957","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"53.289527721","11":"1.559971e-01","12":"0.297","13":"1.0110466","14":"-Inf","15":"1.0110466"},{"1":"sib","2":"dad","3":"0","4":"1957-09-16","5":"1957","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"53.289527721","11":"1.559971e-01","12":"0.297","13":"1.0110466","14":"-Inf","15":"1.0110466"},{"1":"pid","2":"dad","3":"0","4":"1957-09-16","5":"1957","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"53.289527721","11":"1.559971e-01","12":"0.297","13":"1.0110466","14":"-Inf","15":"1.0110466"},{"1":"phs","2":"dad","3":"0","4":"1957-09-16","5":"1957","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"53.289527721","11":"1.559971e-01","12":"0.297","13":"1.0110466","14":"-Inf","15":"1.0110466"},{"1":"mgm","2":"maunt","3":"0","4":"1956-10-04","5":"1956","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"54.239561944","11":"1.589762e-01","12":"0.297","13":"0.9986744","14":"-Inf","15":"0.9986744"},{"1":"maunt","2":"maunt","3":"0","4":"1956-10-04","5":"1956","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"54.239561944","11":"1.589762e-01","12":"0.297","13":"0.9986744","14":"-Inf","15":"0.9986744"},{"1":"macousin","2":"maunt","3":"0","4":"1956-10-04","5":"1956","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"54.239561944","11":"1.589762e-01","12":"0.297","13":"0.9986744","14":"-Inf","15":"0.9986744"},{"1":"mgf","2":"hsmuncle","3":"0","4":"1948-08-08","5":"1948","6":"2015-04-21","7":"2004-04-23","8":"0","9":"NA","10":"55.707049966","11":"1.649439e-01","12":"0.297","13":"0.9743399","14":"-Inf","15":"0.9743399"},{"1":"mgm","2":"mgm","3":"1","4":"1953-03-23","5":"1953","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"57.774127310","11":"1.709366e-01","12":"0.297","13":"0.9504704","14":"-Inf","15":"0.9504704"},{"1":"maunt","2":"mgm","3":"1","4":"1953-03-23","5":"1953","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"57.774127310","11":"1.709366e-01","12":"0.297","13":"0.9504704","14":"-Inf","15":"0.9504704"},{"1":"hsmucousin","2":"hsmuncle","3":"0","4":"1948-08-08","5":"1948","6":"2015-04-21","7":"2008-11-09","8":"0","9":"NA","10":"60.254620123","11":"1.769775e-01","12":"0.297","13":"0.9269450","14":"-Inf","15":"0.9269450"},{"1":"mauntH","2":"macousin","3":"1","4":"1949-06-16","5":"1949","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"61.541409993","11":"1.829406e-01","12":"0.297","13":"0.9042154","14":"-Inf","15":"0.9042154"},{"1":"maunt","2":"macousin","3":"1","4":"1949-06-16","5":"1949","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"61.541409993","11":"1.829406e-01","12":"0.297","13":"0.9042154","14":"-Inf","15":"0.9042154"},{"1":"macousin","2":"macousin","3":"1","4":"1949-06-16","5":"1949","6":"<NA>","7":"2010-12-31","8":"0","9":"NA","10":"61.541409993","11":"1.829406e-01","12":"0.297","13":"0.9042154","14":"-Inf","15":"0.9042154"},{"1":"hsmuncle","2":"hsmuncle","3":"0","4":"1948-08-08","5":"1948","6":"2015-04-21","7":"2010-12-31","8":"0","9":"NA","10":"62.395619439","11":"1.829406e-01","12":"0.297","13":"0.9042154","14":"-Inf","15":"0.9042154"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Note: Currently, it is possible to experience negative ages at the
end of follow up. This is due to the family-wise end of follow up ending
before an individual is born, e.g. proband is diagnosed in their youth,
then has a child later in life. These individuals will get a
non-informative threshold
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mi>∞</mi></mrow><annotation encoding="application/x-tex">-\infty</annotation></semantics></math>
to max of <code>min_CIP_value</code> and the predicted CIP
[<code>K_i</code>]). In other words, these individuals will have no
impact on the estimate.</p>
<p>The function <code><a href="../reference/prepare_LTFHPlus_input.html">prepare_LTFHPlus_input()</a></code> has several
options that are worth pointing out. The first is
<code>use_fixed_case_thr</code>, which is used to determine if the
<code>upper</code> and <code>lower</code> thresholds should be the same
for cases or not. This may be useful if the CIP values are considered
very accurate, as it may lead to more accurate genetic liability
estimates. The second is <code>personal_thr</code>, which specifies if
thresholds should be based on <code>K_i</code> or
<code>K_pop</code>.</p>
<p>The function <code><a href="../reference/prepare_LTFHPlus_input.html">prepare_LTFHPlus_input()</a></code> will return a
tibble with the following additional columns:</p>
<ul>
<li>
<code>K_i</code>: The CIP value for the individual. <code>K_i</code>
is predicted if interpolation is used.</li>
<li>
<code>K_pop</code>: The population prevalence. Currently calculated
as the maximum CIP value within the CIP stratum an individual belongs
to, e.g. for a male born in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2000</mn><annotation encoding="application/x-tex">2000</annotation></semantics></math>,
<code>K_pop</code> is the maximum CIP value observed among males born in
the year
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2000</mn><annotation encoding="application/x-tex">2000</annotation></semantics></math>.</li>
<li>
<code>thr</code>: The liability threshold used to determine
case-control status. <code>thr</code> is used to determine the upper and
lower thresholds of an individual.</li>
<li>
<code>lower</code>: lower threshold of an individual.</li>
<li>
<code>upper</code>: upper threshold of an individual.</li>
</ul>
<p>If the mixture model is not used to calculate the genetic liability,
only <code>lower</code> and <code>upper</code> are needed.</p>
</div>
<div class="section level3">
<h3 id="assign-thresholds-to-family-graphs">Assign thresholds to family graphs<a class="anchor" aria-label="anchor" href="#assign-thresholds-to-family-graphs"></a>
</h3>
<p>The function <code><a href="../reference/estimate_liability.html">estimate_liability()</a></code> can use the family
graphs to calculate all necessary values for the genetic liability, if
the thresholds are stored as attributes in the family graphs. We can
attach the thresholds from <code>fam_thrs</code> to
<code>family_graphs</code> with the function
<code><a href="../reference/fam_graph_attach_attribute.html">fam_graph_attach_attribute()</a></code>. The function merges on the
<code>fid</code> column and attaches any columns in
<code>fam_attr</code> that are specified in <code>cols_to_attach</code>.
Since the purpose of the genetic liability we are estimating is
prediction, we do not wish to use the information from the proband. We
mask the proband’s information by setting the <code>upper</code> and
<code>lower</code> values to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>∞</mi><annotation encoding="application/x-tex">\infty</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mi>∞</mi></mrow><annotation encoding="application/x-tex">-\infty</annotation></semantics></math>
(non-informative values) with the argument
<code>censor_proband_thrs = TRUE</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># attach family specific thresholds</span></span>
<span><span class="va">ltfgrs_input</span> <span class="op">=</span> <span class="fu"><a href="../reference/fam_graph_attach_attribute.html">fam_graph_attach_attribute</a></span><span class="op">(</span>family_graphs <span class="op">=</span> <span class="va">family_graphs</span>,</span>
<span>                                          fam_attr <span class="op">=</span> <span class="va">fam_thrs</span>,</span>
<span>                                          fam_graph_col <span class="op">=</span> <span class="st">"fam_graph"</span>,</span>
<span>                                          attached_fam_graph_col <span class="op">=</span> <span class="st">"masked_fam_graph"</span>,</span>
<span>                                          cols_to_attach <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lower"</span>, <span class="st">"upper"</span><span class="op">)</span>,</span>
<span>                                          censor_proband_thrs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">ltfgrs_input</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 31 × 2</span></span></span>
<span><span class="co">#&gt;   fid   masked_fam_graph</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> dad   <span style="color: #949494;">&lt;igraph&gt;</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> mom   <span style="color: #949494;">&lt;igraph&gt;</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> dad2  <span style="color: #949494;">&lt;igraph&gt;</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> mom2  <span style="color: #949494;">&lt;igraph&gt;</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 27 more rows</span></span></span></code></pre></div>
<p>The format is similar to the one used in
<code><a href="../reference/get_family_graphs.html">get_family_graphs()</a></code>. It is worth noting that the arguement
<code>censor_proband_thrs</code> is only required if the purpose of the
resulting genetic liability is prediction.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ltfgrs_input</span><span class="op">$</span><span class="va">masked_fam_graph</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; IGRAPH f3d8cee DN-- 8 17 -- </span></span>
<span><span class="co">#&gt; + attr: name (v/c), lower (v/n), upper (v/n)</span></span>
<span><span class="co">#&gt; + edges from f3d8cee (vertex names):</span></span>
<span><span class="co">#&gt;  [1] dad   -&gt;paunt  dad   -&gt;puncle dad   -&gt;sib    dad   -&gt;pid    dad   -&gt;phs   </span></span>
<span><span class="co">#&gt;  [6] pgf   -&gt;dad    pgf   -&gt;paunt  pgf   -&gt;puncle pgm   -&gt;dad    pgm   -&gt;paunt </span></span>
<span><span class="co">#&gt; [11] pgm   -&gt;puncle paunt -&gt;dad    paunt -&gt;puncle puncle-&gt;dad    puncle-&gt;paunt </span></span>
<span><span class="co">#&gt; [16] sib   -&gt;pid    pid   -&gt;sib</span></span></code></pre></div>
<p>The second row of the igraph (starting with “+attr:”) shows the
attributes that are available to each node in the graph.</p>
</div>
</div>
<div class="section level2">
<h2 id="estimate-the-genetic-liability">Estimate the genetic liability<a class="anchor" aria-label="anchor" href="#estimate-the-genetic-liability"></a>
</h2>
<p>The function <code><a href="../reference/estimate_liability.html">estimate_liability()</a></code> is used to estimate
the genetic liability. The function accepts two types of input, here we
will only focus on the graph-based input generated above. The
graph-based input offer the best flexibility and scalability. The
function has two arguments that are worth pointing out.</p>
<p>The first is <code>method</code>, which specifies the method used to
estimate the genetic liability. Currently, two methods are supported.
The first is a Gibbs sampler that samples from a truncated multivariate
normal distribution, <code>method = "Gibbs"</code>. The second is an
iterative pearson-aitken approach, <code>method = "PA"</code>. Generally
speaking, the Pearson-Aitken approach is faster.</p>
<p>The second argument is <code>useMixture</code>, which specifies
whether to use the mixture model or not. The mixture model is currently
only supported with <code>method = "PA"</code>. The mixture model
considers the genetic liability of controls as a mixture of the
truncated normal for cases and controls, rather than just the
distribution of controls. This accounts for the possibility that some
controls are undiagnosed cases and accounts for it in the genetic
liability estimate.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ltfgrs_pa</span> <span class="op">=</span> <span class="fu"><a href="../reference/estimate_liability.html">estimate_liability</a></span><span class="op">(</span>family_graphs <span class="op">=</span> <span class="va">ltfgrs_input</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>pid <span class="op">=</span> <span class="va">fid</span><span class="op">)</span>,</span>
<span>                               h2 <span class="op">=</span> <span class="va">h2</span>, </span>
<span>                               fam_id <span class="op">=</span> <span class="st">"fid"</span>,</span>
<span>                               pid <span class="op">=</span> <span class="st">"pid"</span>,</span>
<span>                               family_graphs_col <span class="op">=</span> <span class="st">"masked_fam_graph"</span>,</span>
<span>                               method <span class="op">=</span> <span class="st">"PA"</span>, <span class="co"># &lt;- METHOD</span></span>
<span>                               useMixture <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="co">#&gt; The number of workers is 1</span></span>
<span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html" class="external-link">paged_table</a></span><span class="op">(</span><span class="va">ltfgrs_pa</span><span class="op">)</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["fid"],"name":[1],"type":["chr"],"align":["left"]},{"label":["pid"],"name":[2],"type":["chr"],"align":["left"]},{"label":["est"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["var"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"dad","2":"dad","3":"3.087731e-01","4":"0.3859765"},{"1":"mom","2":"mom","3":"-7.613791e-02","4":"0.4648992"},{"1":"dad2","2":"dad2","3":"3.569796e-01","4":"0.4183973"},{"1":"mom2","2":"mom2","3":"-3.565775e-02","4":"0.4855060"},{"1":"mgf","2":"mgf","3":"3.848076e-01","4":"0.4138863"},{"1":"mgm","2":"mgm","3":"4.590348e-01","4":"0.4303922"},{"1":"pgf","2":"pgf","3":"-1.195253e-01","4":"0.4568529"},{"1":"pgm","2":"pgm","3":"-1.685667e-01","4":"0.4405807"},{"1":"pgf2","2":"pgf2","3":"-1.753801e-02","4":"0.4914463"},{"1":"pgm2","2":"pgm2","3":"-1.753801e-02","4":"0.4914463"},{"1":"pauntH","2":"pauntH","3":"-3.954493e-02","4":"0.4844110"},{"1":"paunt","2":"paunt","3":"3.872488e-01","4":"0.4008357"},{"1":"newpgf","2":"newpgf","3":"-9.615933e-03","4":"0.4946911"},{"1":"hspauntH","2":"hspauntH","3":"-3.696252e-02","4":"0.4851327"},{"1":"hspaunt","2":"hspaunt","3":"5.919867e-01","4":"0.4209053"},{"1":"puncle","2":"puncle","3":"3.903693e-01","4":"0.4024090"},{"1":"puncleW","2":"puncleW","3":"-2.481221e-02","4":"0.4888676"},{"1":"mauntH","2":"mauntH","3":"-8.110650e-02","4":"0.4750873"},{"1":"maunt","2":"maunt","3":"7.330779e-01","4":"0.3787566"},{"1":"newmgm","2":"newmgm","3":"-3.302013e-02","4":"0.4862793"},{"1":"hsmuncle","2":"hsmuncle","3":"1.402709e+00","4":"0.3595848"},{"1":"hsmuncleW","2":"hsmuncleW","3":"-5.035604e-05","4":"0.4999509"},{"1":"sib","2":"sib","3":"4.062689e-01","4":"0.4126918"},{"1":"pid","2":"pid","3":"4.195418e-01","4":"0.4138643"},{"1":"mhs","2":"mhs","3":"5.576624e-01","4":"0.4452265"},{"1":"phs","2":"phs","3":"-1.167455e-01","4":"0.4597927"},{"1":"pacousin","2":"pacousin","3":"-6.260233e-02","4":"0.4740753"},{"1":"hspacousin","2":"hspacousin","3":"7.098542e-01","4":"0.4236598"},{"1":"pucousin","2":"pucousin","3":"-5.083796e-02","4":"0.4774512"},{"1":"macousin","2":"macousin","3":"-9.542221e-02","4":"0.4661757"},{"1":"hsmucousin","2":"hsmucousin","3":"4.788523e-01","4":"0.4207818"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>When using <code>method = "PA"</code>, an iterative conditioning is
performed, which means the resulting estimate and uncertainty of the
estimate is the expected mean value and variance of the last iteration,
which is the proband’s genetic liability. This is highlighted by the use
of <code>var</code> in the output.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ltfgrs_gibbs</span> <span class="op">=</span> <span class="fu"><a href="../reference/estimate_liability.html">estimate_liability</a></span><span class="op">(</span>family_graphs <span class="op">=</span> <span class="va">ltfgrs_input</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>pid <span class="op">=</span> <span class="va">fid</span><span class="op">)</span>, </span>
<span>                                  h2 <span class="op">=</span> <span class="va">h2</span>,</span>
<span>                                  fam_id <span class="op">=</span> <span class="st">"fid"</span>,</span>
<span>                                  pid <span class="op">=</span> <span class="st">"pid"</span>,</span>
<span>                                  family_graphs_col <span class="op">=</span> <span class="st">"masked_fam_graph"</span>,</span>
<span>                                  method <span class="op">=</span> <span class="st">"Gibbs"</span>, <span class="co"># &lt;- METHOD</span></span>
<span>                                  useMixture <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="co">#&gt; The number of workers is 1</span></span>
<span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html" class="external-link">paged_table</a></span><span class="op">(</span><span class="va">ltfgrs_gibbs</span><span class="op">)</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["fid"],"name":[1],"type":["chr"],"align":["left"]},{"label":["pid"],"name":[2],"type":["chr"],"align":["left"]},{"label":["genetic_est"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["genetic_se"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"dad","2":"dad","3":"0.293180498","4":"0.003669032"},{"1":"mom","2":"mom","3":"-0.076377007","4":"0.004378651"},{"1":"dad2","2":"dad2","3":"0.366387479","4":"0.003825374"},{"1":"mom2","2":"mom2","3":"-0.037086453","4":"0.004039444"},{"1":"mgf","2":"mgf","3":"0.366400617","4":"0.003516957"},{"1":"mgm","2":"mgm","3":"0.453088856","4":"0.003268458"},{"1":"pgf","2":"pgf","3":"-0.116934093","4":"0.003876705"},{"1":"pgm","2":"pgm","3":"-0.170529736","4":"0.003555503"},{"1":"pgf2","2":"pgf2","3":"-0.021757479","4":"0.004003183"},{"1":"pgm2","2":"pgm2","3":"-0.014418417","4":"0.003943239"},{"1":"pauntH","2":"pauntH","3":"-0.039027707","4":"0.003741743"},{"1":"paunt","2":"paunt","3":"0.387775840","4":"0.003530268"},{"1":"newpgf","2":"newpgf","3":"-0.009989302","4":"0.004160466"},{"1":"hspauntH","2":"hspauntH","3":"-0.037936477","4":"0.003911595"},{"1":"hspaunt","2":"hspaunt","3":"0.591135947","4":"0.003622480"},{"1":"puncle","2":"puncle","3":"0.388088930","4":"0.003549055"},{"1":"puncleW","2":"puncleW","3":"-0.014620626","4":"0.003746675"},{"1":"mauntH","2":"mauntH","3":"-0.077909691","4":"0.003906064"},{"1":"maunt","2":"maunt","3":"0.721878026","4":"0.003167138"},{"1":"newmgm","2":"newmgm","3":"-0.035700844","4":"0.004039608"},{"1":"hsmuncle","2":"hsmuncle","3":"1.410673365","4":"0.003231656"},{"1":"hsmuncleW","2":"hsmuncleW","3":"-0.003727006","4":"0.003958302"},{"1":"sib","2":"sib","3":"0.403216112","4":"0.003612521"},{"1":"pid","2":"pid","3":"0.417403288","4":"0.003685654"},{"1":"mhs","2":"mhs","3":"0.558675326","4":"0.003594503"},{"1":"phs","2":"phs","3":"-0.111119716","4":"0.003903085"},{"1":"pacousin","2":"pacousin","3":"-0.062403324","4":"0.004285129"},{"1":"hspacousin","2":"hspacousin","3":"0.706277968","4":"0.003583150"},{"1":"pucousin","2":"pucousin","3":"-0.053464497","4":"0.003894541"},{"1":"macousin","2":"macousin","3":"-0.097059043","4":"0.004076257"},{"1":"hsmucousin","2":"hsmucousin","3":"0.477608748","4":"0.003472688"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>When using <code>method = Gibbs</code>, samples are drawn from a
truncated multivariate normal distribution until the convergence
criteria is met. The output is the mean of genetic liability and the
uncertainty is the standard error of the mean. The standard error is
denoted with the <code>se</code> in the column name. Noteably, the
uncertainties with the Gibbs and PA methods are different and should not
be directly compared.</p>
<div class="section level3">
<h3 id="parallelisation">Parallelisation<a class="anchor" aria-label="anchor" href="#parallelisation"></a>
</h3>
<p>The function <code><a href="../reference/estimate_liability.html">estimate_liability()</a></code> is able to use the
<code>future</code> package to parallelise the estimation of the genetic
liability. This is done by setting a suitable <code>plan</code> with the
future backend. A plan suitable for most needs is
<code>plan(multisession, workers = NCORES)</code>, which means that the
function will run in parallel on the local PC utilising
<code>NCORES</code>-cores. Other parallelisation options exist, but they
are all handled by the future suit of packages.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Emil Michael Pedersen, Jette Steinbach.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
